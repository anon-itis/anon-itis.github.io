var app=angular.module("AnonITIS",["firebase"]);app.filter("reverse",function(){return function(e){return e?e.slice().reverse():void 0}}),app.value("fbURL","https://anon-itis.firebaseio.com/"),app.service("VK",[function(){return VK}]),app.service("Test",["$firebase","fbURL",function(e,n){var t=new Firebase(n+"test"),o=e(t).$asArray();return o}]),app.controller("MainCtrl",["$scope","VK","$interval","Test","$http",function(e,n,t,o,r){t(),o.$loaded(function(){e.test=o,e.authInfo=function(n){n.session&&(e.user=n.session.mid)},n.init({apiId:4726521}),n.Auth.getLoginStatus(e.authInfo),e.login=function(){n.Auth.login(e.authInfo)},e.logout=function(){n.Auth.logout(function(){e.user=!1})};var t={};e.users=function(e){return t[e]?t[e]:(t[e]=!0,void r.jsonp("https://api.vk.com/method/users.get?user_ids="+e+"&fields=photo_100&v=5.27&callback=JSON_CALLBACK ").success(function(n){n.response&&(t[e]=n.response[0])}))},e.sendPost=function(){o.$add({owner:parseInt(e.user),anon:e.newPostAnon?1:0,text:e.newPost.toString().replace(/ +/g," "),date:Math.round((new Date).getTime()/1e3)}),e.newPost=""},e.comText={},e.comAnon={},e.sendComment=function(n){var t={owner:parseInt(e.user),anon:e.comAnon[n]?1:0,text:e.comText[n],date:Math.round((new Date).getTime()/1e3)},r=o.$getRecord(n);r.comments?r.comments.push(t):r.comments=[t],o.$save(r),e.comText[n]=""}})}]);